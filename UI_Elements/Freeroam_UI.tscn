[gd_scene load_steps=3 format=3 uid="uid://b5q4e5i4nbggr"]

[sub_resource type="GDScript" id="GDScript_7elw1"]
script/source = "extends Control

@export_group(\"Pathways\", \"path_\")
@export var path_name : PackedStringArray
@export var path_color : PackedColorArray



func _ready():
	%Pathways.columns = max(ceili(path_name.size() / 6.0), 1)
	for i in range(path_name.size()):
		var path_label = Label.new()
		var path_rect = ColorRect.new()
		path_label.text = path_name[i]
		path_rect.color = path_color[i]
		path_rect.custom_minimum_size = Vector2(100, 20)
		%Pathways.add_child(path_label)
		%Pathways.add_child(path_rect)


func update_intel(chara:Character):
	%pause.text = chara.human_name()
	var zone_name : String = chara.at_zone
	if zone_name.is_empty():
		zone_name = $\"../..\".default_zone_name
	%Location.text = zone_name

func _on_pause_pressed():
	get_tree().call_group(\"when_paused\", \"_on_game_paused\")


func _on_chara_changed_zone(who:Character) -> void:
	if who == Ses.curr_unit():
		update_intel(who)
	
"

[sub_resource type="StyleBoxFlat" id="StyleBoxFlat_3ydge"]
content_margin_left = 6.0
content_margin_right = 6.0
content_margin_bottom = 6.0
bg_color = Color(0.226707, 0.226708, 0.226707, 1)
corner_radius_bottom_right = 14
corner_radius_bottom_left = 14
expand_margin_top = 20.0
shadow_size = 4
shadow_offset = Vector2(3, 2)

[node name="Player_UI" type="Control" groups=["track_chara_zone"]]
layout_mode = 3
anchors_preset = 15
anchor_right = 1.0
anchor_bottom = 1.0
grow_horizontal = 2
grow_vertical = 2
mouse_filter = 2
script = SubResource("GDScript_7elw1")
path_name = PackedStringArray("Dojo")
path_color = PackedColorArray(0, 0, 0, 1)

[node name="MarginContainer" type="MarginContainer" parent="."]
layout_mode = 1
anchors_preset = 10
anchor_right = 1.0
offset_bottom = 117.0
grow_horizontal = 2
mouse_filter = 0
theme_override_constants/margin_left = 20
theme_override_constants/margin_top = 20
theme_override_constants/margin_right = 20
theme_override_constants/margin_bottom = 20

[node name="HBoxContainer" type="HBoxContainer" parent="MarginContainer"]
layout_mode = 2
size_flags_vertical = 0
theme_override_constants/separation = 12

[node name="VBoxContainer2" type="VBoxContainer" parent="MarginContainer/HBoxContainer"]
layout_mode = 2
theme_override_constants/separation = 12

[node name="Location" type="Label" parent="MarginContainer/HBoxContainer/VBoxContainer2"]
unique_name_in_owner = true
layout_mode = 2
size_flags_vertical = 0
theme_override_styles/normal = SubResource("StyleBoxFlat_3ydge")
text = "Nowhere"
horizontal_alignment = 1

[node name="pause" type="Button" parent="MarginContainer/HBoxContainer/VBoxContainer2"]
unique_name_in_owner = true
layout_mode = 2
focus_mode = 0
text = "Curr Unit"

[node name="VBoxContainer" type="VBoxContainer" parent="MarginContainer/HBoxContainer"]
layout_mode = 2
size_flags_horizontal = 3
size_flags_vertical = 8

[node name="Label" type="Label" parent="MarginContainer/HBoxContainer/VBoxContainer"]
layout_mode = 2
text = "Pathway Legend: Level -5"

[node name="Pathways" type="GridContainer" parent="MarginContainer/HBoxContainer/VBoxContainer"]
unique_name_in_owner = true
layout_mode = 2
columns = 2

[connection signal="pressed" from="MarginContainer/HBoxContainer/VBoxContainer2/pause" to="." method="_on_pause_pressed"]
